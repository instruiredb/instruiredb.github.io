<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Mecanic LocomotivƒÉ - LDE 232 Ludmila</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            position: relative; /* Pentru a pozi»õiona semnƒÉtura relativ la container */
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .personal-info {
            padding: 40px;
            max-width: 600px;
            margin: 0 auto;
        }

        .personal-info h2 {
            color: #667eea;
            margin-bottom: 30px;
            text-align: center;
            font-size: 24px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .form-group input[type="text"],
        .form-group input[type="date"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input[type="text"]:focus,
        .form-group input[type="date"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .radio-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 10px 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
        }

        .radio-label:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .radio-label input[type="radio"] {
            margin-right: 8px;
            cursor: pointer;
        }

        .quiz-content {
            padding: 30px;
        }

        .question-block {
            margin-bottom: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .question-number {
            color: #667eea;
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            line-height: 1.6;
            color: #2c3e50;
        }

        .question-image {
            margin: 15px 0;
            text-align: center;
        }

        .question-image img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .options {
            margin-top: 15px;
        }

        .option {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: flex-start;
        }

        .option:hover {
            border-color: #667eea;
            transform: translateX(5px);
        }

        .option input[type="radio"],
        .option input[type="checkbox"] {
            margin-right: 12px;
            margin-top: 3px;
            cursor: pointer;
            width: 18px;
            height: 18px;
        }

        .option label {
            cursor: pointer;
            flex: 1;
            line-height: 1.5;
        }

        .option.correct {
            background: #d4edda;
            border-color: #28a745;
        }

        .option.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .option.correct::before {
            content: "‚úì ";
            color: #28a745;
            font-weight: bold;
            margin-right: 5px;
        }

        .option.incorrect::before {
            content: "‚úó ";
            color: #dc3545;
            font-weight: bold;
            margin-right: 5px;
        }

        .btn-container {
            text-align: center;
            margin: 30px 0;
            padding: 0 30px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            box-shadow: none;
        }

        .results {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 30px;
            text-align: center;
            display: none;
        }

        .results.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .results h2 {
            font-size: 24px;
            margin-bottom: 15px;
        }

        .results .score {
            font-size: 48px;
            font-weight: bold;
            margin: 20px 0;
        }

        .score-message {
            font-size: 18px;
            margin-top: 10px;
        }

        .reset-btn {
            background: white;
            color: #f5576c;
            margin-top: 20px;
        }

        .export-section {
            text-align: center;
            margin: 20px 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            display: none;
        }

        .export-section.show {
            display: block;
        }

        .export-section h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .export-btn {
            background: #28a745;
            margin: 5px;
        }

        .export-btn:hover {
            background: #218838;
        }

        .summary-text {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: left;
            margin: 20px 0;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        
        .signature-section {
            padding: 20px 30px 40px;
            text-align: right;
            margin-top: 20px;
        }

        .signature {
            font-family: 'Dancing Script', cursive;
            font-size: 28px;
            color: #2c3e50;
            font-weight: 700;
            display: inline-block;
            border-top: 1px solid #ccc; /* Linie sub semnƒÉturƒÉ */
            padding-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÇ Test LDE 232 Ludmila</h1>
            <p>Verificarea Cuno»ôtin»õelor - 15 √éntrebƒÉri</p>
        </div>

        <div class="personal-info" id="personalInfo">
            <h2>Date Personale</h2>
            <div class="form-group">
                <label for="nume">Nume »ôi Prenume *</label>
                <input type="text" id="nume" required placeholder="Ex: Popescu Ion">
            </div>
            <div class="form-group">
                <label>Func»õia *</label>
                <div class="radio-group">
                    <label class="radio-label">
                        <input type="radio" name="functie" value="Mecanic" required>
                        Mecanic
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="functie" value="Mecanic Ajutor" required>
                        Mecanic Ajutor
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label for="data">Data *</label>
                <input type="date" id="data" required>
            </div>
            <button class="btn" onclick="startQuiz()">√éncepe Testul</button>
        </div>

        <div class="quiz-content" id="quizContent" style="display:none;"></div>

        <div class="btn-container">
            <button class="btn" id="checkBtn" onclick="checkAnswers()" style="display:none;">VerificƒÉ RƒÉspunsurile</button>
            <button class="btn reset-btn" id="resetBtn" onclick="resetQuiz()" style="display:none;">Reia Testul</button>
        </div>

        <div class="results" id="results"></div>

        <div class="export-section" id="exportSection">
            <h3>üì• ExportƒÉ Rezultatele</h3>
            <button class="btn export-btn" onclick="exportToText()">üíæ DescarcƒÉ ca Text</button>
            <button class="btn export-btn" onclick="copyToClipboard()">üìã CopiazƒÉ √Æn Clipboard</button>
            <button class="btn export-btn" onclick="printResults()">üñ®Ô∏è PrinteazƒÉ</button>
            <div class="summary-text" id="summaryText"></div>
        </div>
        
        <div class="signature-section">
            <div style="font-size: 14px; margin-bottom: 5px; color: #555;">√éntocmit</div>
            <div class="signature">Ecobici Marian</div>
        </div>
        </div>

    <script>
        const questions = [
            { id: 1, text: "Care este regimul de func≈£ionare al MD pe pozi≈£ia REMIZAT la LDE 232?", options: ["A) 750 rot/min.", "B) 350 rot/min.", "C) 650 rot/min."], correct: 1 },
            { id: 2, text: "Care este temperatura la care porneste automat MDA pe pozitia REMIZAT?", options: ["A) 40 ¬∞C.", "B) 30 ¬∞C.", "C) 25 ¬∞C."], correct: 2 },
            { id: 3, text: "Care este presiunea minima a uleiului la preungerea MD pentru lansare?", options: ["A) 0.5 bari.", "B) 1.1 bari.", "C) 0.2 bari."], correct: 2 },
            { id: 4, text: "Ce componente se rotesc la lansarea MD la LDE 232?", options: ["A) Motorul diesel, generatorul principal, generatorul auxiliar, compresorul de aer ≈üi grupul de pompe hidraulice.", "B) Motorul diesel, generatorul principal ≈üi grupul de pompe hidraulice.", "C) Motorul diesel, generatorul principal, generatorul auxiliar ≈üi grupul de pompe hidraulice."], correct: 2 },
            { id: 5, text: "Ce componenta asigura preungerea MD la LDE 232?", options: ["A) Pompa de preungere de ulei de ungere.", "B) Pompa de combustibil.", "C) Pompa de preungere de apa de racire."], correct: 0 },
            { id: 6, text: "Care din urmatoarele elemente de protec≈£ie pot comanda scoaterea din sarcina a grupului MD-GP? (Selecta»õi toate rƒÉspunsurile corecte)", options: ["A) Scoaterea din sarcina a grupului MD-GP", "B) Semnalizare prin instala≈£ia de apel optic", "C) Tensiunea bateriei este prea micƒÉ sau inexistenta"], correct: [0, 1], type: 'multiple', correct_text: "A, B" },
            { id: 7, text: "Care este presiunea minima a uleiului la preungerea MD pentru lansare?", options: ["A) 0.5 bari.", "B) 1.1 bari.", "C) 0.2 bari."], correct: 2 },
            { id: 8, text: "Ce componenta este reprezentata in imagine?", options: ["A) Instalatia tip AST-LOOS.", "B) Filtrul micronic.", "C) Filtrul de ulei centrifugal."], correct: 1, image: "images/232.8.jpg" },
            { id: 9, text: "Pe ce instrumente se mai poate citi diferenta de presiune de ulei la intrarea si iesirea uleiului in filtrul micronic?", options: ["A) Pe panoul de manometre aflat pe peretele dintre camera de racire si camera motorului diesel.", "B) Pe panoul de manometre aflat in postul de conducere.", "C) Pe panoul de manometre aflat pe peretele dintre postul de conducere si camera motorului."], correct: 0 },
            { id: 10, text: "Cum este presiunea uluiului la intrarea si iesirea din filtrul micronic atunci cand ambele cadrane sunt de culoarea gri ?", options: ["A) Diferenta de presiune este sub 0.2 bar.", "B) Diferenta de presiune este peste 0.5 bar.", "C) Diferenta de presiune este intre 0.2 si 0.5 bar."], correct: 0 },
            { id: 11, text: "Ce semnalizeazƒÉ supapa indicatoare a filtrului de ulei de ungere c√¢nd apare culoarea ro≈üu-alb ?", options: ["A) Inunda≈£ia cu ulei a MD", "B) Filtru √Ænfundat - uleiul se scurge √Æn carter", "C) Scurgerea apei de rƒÉcire √Æn carterul MD"], correct: 1 },
            { id: 12, text: "Oprirea necomandata a MD la LDE 232, este comandata de unul din urmƒÉtoarele motive: (Selecta»õi toate rƒÉspunsurile corecte)", options: ["A) Presiunea apei de racire scade sub 0.3 bar", "B) Presiunea uleiului de ungere scade sub 1.5 bar", "C) Tura≈£ia MD depƒÉ≈üe≈üte 1150 rot/min"], correct: [0, 1, 2], type: 'multiple', correct_text: "A, B, C" },
            { id: 13, text: "Ce se comanda la aparitia defectului de presiune aer frana sau la caderea presiunii din CG sub 3.6 bar?", options: ["A) ComandƒÉ scoatere din sarcinƒÉ, semnalizare luminoasƒÉ la postul de conducere", "B) ComandƒÉ oprire MD, semnalizare luminoasƒÉ la postul de conducere", "C) ComandƒÉ oprire for»õatƒÉ a trenului"], correct: 0 },
            { id: 14, text: "Care din urmatoarele defecte pot comanda oprirea necomandata a MD? (Selecta»õi toate rƒÉspunsurile corecte)", options: ["A) Temperatura lichidului de rƒÉcire depƒÉ≈üe≈üte 95 ¬∞C", "B) Intensitatea curentului de trac≈£iune mai mare de 6600 A.", "C) Ventilatia motoarele de tractiune nu functioneaza."], correct: [0, 1, 2], type: 'multiple', correct_text: "A, B, C" },
            { id: 15, text: "Oprirea necomandata a MD poate fi comandata si de cresterea temparaturii lichidului de racire la o temperatura mai mare de 95¬∞C", options: ["A) AdevƒÉrat.", "B) Fals."], correct: 1 }
        ];

        let userAnswers = {};
        let checked = false;
        let personalData = {};
        // Identificator unic al testului pentru numele fi»ôierului
        const TEST_SLUG = "LDE_232_Ludmila";
        const TOTAL_QUESTIONS = questions.length;

        function startQuiz() {
            const nume = document.getElementById('nume').value.trim();
            const functieElement = document.querySelector('input[name="functie"]:checked');
            const data = document.getElementById('data').value;

            if (!nume || !functieElement || !data) {
                alert('‚ö†Ô∏è Te rog completeazƒÉ toate c√¢mpurile obligatorii (Nume, Func»õie, Data)!');
                return;
            }

            personalData = {
                nume: nume,
                functie: functieElement.value, 
                data: data
            };

            document.getElementById('personalInfo').style.display = 'none';
            document.getElementById('quizContent').style.display = 'block';
            // AratƒÉ butonul 'VerificƒÉ RƒÉspunsurile' acum
            document.getElementById('checkBtn').style.display = 'inline-block'; 
            renderQuiz();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function renderQuiz() {
            const quizContent = document.getElementById('quizContent');
            let html = '';

            questions.forEach((q) => {
                const isMultipleAnswer = Array.isArray(q.correct);
                const inputType = isMultipleAnswer ? 'checkbox' : 'radio';

                html += `
                    <div class="question-block" id="q${q.id}">
                        <div class="question-number">√éntrebarea ${q.id}</div>
                        <div class="question-text">${q.text}</div>
                `;

                if (q.image) {
                    html += `
                        <div class="question-image">
                            <img src="${q.image}" alt="Imagine √Æntrebarea ${q.id}">
                        </div>
                    `;
                }
                
                html += `<div class="options">`;

                q.options.forEach((option, optIndex) => {
                    if (isMultipleAnswer) {
                        html += `
                            <div class="option" onclick="selectMultipleOption(${q.id}, ${optIndex})">
                                <input type="checkbox" name="q${q.id}_opt${optIndex}" id="q${q.id}_opt${optIndex}" value="${optIndex}">
                                <label for="q${q.id}_opt${optIndex}">${option}</label>
                            </div>
                        `;
                    } else {
                        html += `
                            <div class="option" onclick="selectOption(${q.id}, ${optIndex})">
                                <input type="radio" name="q${q.id}" id="q${q.id}_opt${optIndex}" value="${optIndex}">
                                <label for="q${q.id}_opt${optIndex}">${option}</label>
                            </div>
                        `;
                    }
                });

                html += `
                        </div>
                    </div>
                `;
            });

            quizContent.innerHTML = html;
        }

        function selectOption(questionId, optionIndex) {
            if (checked) return;
            userAnswers[questionId] = optionIndex;
            const radio = document.getElementById(`q${questionId}_opt${optionIndex}`);
            radio.checked = true;
        }

        function selectMultipleOption(questionId, optionIndex) {
            if (checked) return;
            
            // Logica de actualizare pentru rƒÉspunsurile multiple
            if (!Array.isArray(userAnswers[questionId])) {
                userAnswers[questionId] = [];
            }
            
            const indexInArray = userAnswers[questionId].indexOf(optionIndex);
            const input = document.getElementById(`q${questionId}_opt${optionIndex}`);

            if (indexInArray > -1) {
                userAnswers[questionId].splice(indexInArray, 1); // Remove
                input.checked = false;
            } else {
                userAnswers[questionId].push(optionIndex); // Add
                input.checked = true;
            }

            // AsigurƒÉ sortarea pentru a facilita compara»õia ulterioarƒÉ
            userAnswers[questionId].sort((a, b) => a - b);
        }

        // Func»õie ajutƒÉtoare pentru a compara array-uri (rƒÉspunsuri multiple)
        function arraysEqual(a, b) {
            if (a === b) return true;
            if (a == null || b == null) return false;
            if (a.length !== b.length) return false;
            const sortedA = [...a].sort();
            const sortedB = [...b].sort();
            for (let i = 0; i < sortedA.length; i++) {
                if (sortedA[i] !== sortedB[i]) return false;
            }
            return true;
        }

        function checkAnswers() {
            if (checked) return;
            
            // NOU: Verificarea RƒÉspunsurilor complete 
            if (Object.keys(userAnswers).length !== TOTAL_QUESTIONS) {
                const missing = TOTAL_QUESTIONS - Object.keys(userAnswers).length;
                alert(`‚ö†Ô∏è Nu ai rƒÉspuns la toate √ÆntrebƒÉrile! Ai √ÆncƒÉ ${missing} √ÆntrebƒÉri nerezolvate. VƒÉ rugƒÉm rƒÉspunde»õi la toate √Ænainte de verificare.`);
                return; 
            }
            
            checked = true;
            let score = 0;

            questions.forEach(q => {
                const options = document.querySelectorAll(`#q${q.id} .option`);
                const userAnswer = Array.isArray(q.correct) ? (userAnswers[q.id] || []) : userAnswers[q.id];
                let isCorrect = false;

                if (Array.isArray(q.correct)) {
                    // Logica pentru rƒÉspuns multiplu
                    isCorrect = arraysEqual(userAnswer, q.correct);
                    
                    options.forEach((opt, index) => {
                        opt.style.pointerEvents = 'none';
                        const input = opt.querySelector('input');
                        const isCorrectOption = q.correct.includes(index);
                        const isUserSelected = userAnswer.includes(index);
                        
                        // MarcheazƒÉ op»õiunile corecte
                        if (isCorrectOption) {
                            opt.classList.add('correct');
                        }
                        // MarcheazƒÉ op»õiunile selectate incorect (sau lipsa celor corecte)
                        if (isUserSelected && !isCorrectOption) {
                            opt.classList.add('incorrect');
                        }
                    });

                } else {
                    // Logica pentru rƒÉspuns simplu (radio)
                    isCorrect = userAnswer === q.correct;

                    options.forEach((opt, index) => {
                        opt.style.pointerEvents = 'none';
                        
                        if (index === q.correct) {
                            opt.classList.add('correct');
                        }
                        
                        if (userAnswer !== undefined && index === userAnswer && userAnswer !== q.correct) {
                            opt.classList.add('incorrect');
                        }
                    });
                }

                if (isCorrect) {
                    score++;
                }
            });

            const percentage = Math.round((score / TOTAL_QUESTIONS) * 100);
            
            // Logica de calificare: A: 14-15; B: 11-13; C: 8-10; D: 0-7
            let message = '';
            let calificativ = '';
            let status = '‚ùå NECORESPUNZƒÇTOR';

            if (score >= 14) {
                calificativ = 'A';
                message = 'üéâ Excelent! Cuno»ôti foarte bine materia!';
                status = '‚úÖ CORESPUNZƒÇTOR';
            } else if (score >= 11) {
                calificativ = 'B';
                message = 'üëç Foarte bine! ContinuƒÉ sƒÉ √Ænve»õi!';
                status = '‚úÖ CORESPUNZƒÇTOR';
            } else if (score >= 8) {
                calificativ = 'C';
                message = 'üìö Bine, dar mai este loc de √ÆmbunƒÉtƒÉ»õire!';
                status = '‚úÖ CORESPUNZƒÇTOR';
            } else {
                calificativ = 'D';
                message = 'üìñ Trebuie sƒÉ mai studiezi materia!';
            }

            document.getElementById('results').innerHTML = `
                <h2>Rezultate Test</h2>
                <div class="score">${score} / ${TOTAL_QUESTIONS}</div>
                <div class="score-message">${percentage}% - Calificativ: ${calificativ} - ${status}</div>
                <div class="score-message">${message}</div>
            `;
            document.getElementById('results').classList.add('show');
            document.getElementById('checkBtn').style.display = 'none';
            document.getElementById('resetBtn').style.display = 'inline-block';

            generateSummary(score, percentage, calificativ, status);
            document.getElementById('exportSection').classList.add('show');
            
            // NOU: DescƒÉrcare automatƒÉ ca text 
            exportToText();

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function getAnswerText(q, userAnswer) {
            if (userAnswer === undefined || userAnswer.length === 0) {
                return 'Niciun rƒÉspuns';
            }
            if (Array.isArray(q.correct)) {
                return userAnswer.map(index => q.options[index].replace(/^[A-C]\)\s*/, '')).join(' | ');
            }
            return q.options[userAnswer].replace(/^[A-C]\)\s*/, '');
        }

        function getCorrectAnswerText(q) {
            if (Array.isArray(q.correct)) {
                return q.correct.map(index => q.options[index].replace(/^[A-C]\)\s*/, '')).join(' | ');
            }
            return q.options[q.correct].replace(/^[A-C]\)\s*/, '');
        }

        function generateSummary(score, percentage, calificativ, status) {
            const date = new Date(personalData.data);
            const formattedDate = date.toLocaleDateString('ro-RO', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });

            let summary = `
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë             TEST MECANIC LOCOMOTIVƒÇ - LDE 232 Ludmila          ‚ïë
‚ïë               (VERIFICAREA CUNO»òTIN»öELOR - ${TOTAL_QUESTIONS} √éNTREBƒÇRI)              ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üìã DATE PERSONALE:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
   Nume »ôi Prenume: ${personalData.nume}
   Func»õia: ${personalData.functie}
   Data testului: ${formattedDate}

üìä REZULTATE:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
   Punctaj: ${score} / ${TOTAL_QUESTIONS}
   Procent: ${percentage}%
   Calificativ: ${calificativ}
   Status: ${status}

üìù RƒÇSPUNSURI DETALIATE:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
`;

            questions.forEach(q => {
                const userAnswer = Array.isArray(q.correct) ? (userAnswers[q.id] || []) : userAnswers[q.id];
                let isCorrect = false;

                if (Array.isArray(q.correct)) {
                    isCorrect = arraysEqual(userAnswer, q.correct);
                } else {
                    isCorrect = userAnswer === q.correct;
                }
                
                const statusIcon = isCorrect ? '‚úì' : '‚úó';
                
                const givenAnswerText = getAnswerText(q, userAnswer);
                const correctAnswerText = getCorrectAnswerText(q);

                summary += `
${statusIcon} √éntrebarea ${q.id}: ${isCorrect ? 'CORECT' : 'GRE»òIT'}
   ${q.text}
   ${q.image ? `[Imagine: ${q.image}]` : ''}
   RƒÉspuns dat: ${givenAnswerText}
   RƒÉspuns corect: ${correctAnswerText}
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
`;
            });

            summary += `
√éntocmit
Ecobici Marian
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚ïë  Document generat automat - ${new Date().toLocaleString('ro-RO')}  ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
`;

            document.getElementById('summaryText').textContent = summary;
            return summary;
        }

        function exportToText() {
            const summary = document.getElementById('summaryText').textContent;
            const blob = new Blob([summary], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Test_${TEST_SLUG}_${personalData.nume.replace(/\s+/g, '_')}_${personalData.data}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function copyToClipboard() {
            const summary = document.getElementById('summaryText').textContent;
            navigator.clipboard.writeText(summary).then(() => {
                alert('‚úÖ Rezultatele au fost copiate √Æn clipboard!');
            }).catch(err => {
                alert('‚ùå Eroare la copierea √Æn clipboard: ' + err);
            });
        }

        function printResults() {
            const summary = document.getElementById('summaryText').textContent;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>Test Mecanic LocomotivƒÉ - ${personalData.nume}</title>
                    <style>
                        body { font-family: 'Courier New', monospace; padding: 20px; }
                        pre { white-space: pre-wrap; line-height: 1.6; }
                    </style>
                </head>
                <body>
                    <pre>${summary}</pre>
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        function resetQuiz() {
            checked = false;
            userAnswers = {};
            
            document.getElementById('results').classList.remove('show');
            document.getElementById('exportSection').classList.remove('show');
            document.getElementById('checkBtn').style.display = 'none';
            document.getElementById('resetBtn').style.display = 'none';
            document.getElementById('personalInfo').style.display = 'block';
            document.getElementById('quizContent').style.display = 'none';
            
            document.getElementById('nume').value = '';
            document.querySelectorAll('input[name="functie"]').forEach(r => r.checked = false); // DebifeazƒÉ toate
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Ini»õializare: SeteazƒÉ data curentƒÉ ca default
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('data').value = today;
        });
    </script>
</body>
</html>